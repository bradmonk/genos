function [] = GENOS_MATCAT(FILES,SAVENAME)
%% GENOS_SUBSAM_MATCAT
% EXAMPLE USAGE
%-------------------------------------------------
%{
clc; close all; clear






%##############################################################################
%##############################################################################
% APOE 22 23 24 33 34 44 (HILO)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_HILO_p01p05.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_HILO_p06p15.mat';
}
SAVENAME = 'APOE_22_23_24_33_34_44_HILO_p01p15';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)



% APOE 22 23 24 33 34 44 (WIN50)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN50_p01-05.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN50_p06-15.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN50_p16-25.mat';
}
SAVENAME = 'APOE_22_23_24_34_44_WIN50_p01p25';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)




% APOE 22 23 24 33 34 44 (WIN20)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN20_p01-05.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN20_p06-15.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_33_34_44/APOE_22_23_24_33_34_44_WIN20_p16-25.mat';
}
SAVENAME = 'APOE_22_23_24_33_34_44_WIN50_p01p25';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)

%##############################################################################
%##############################################################################







%##############################################################################
%##############################################################################
% APOE 22 23 24 34 44 (HILO)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_NNHILO.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_NNHILO.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_NNHILO.mat';
}
SAVENAME = 'APOE_22_23_24_34_44_HILO_p01p25';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)



% APOE 22 23 24 34 44 (WIN50)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN50_p01-05.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN50_p06-15.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN50_p16-25.mat';
}
SAVENAME = 'APOE_22_23_24_34_44_WIN50_p01p25';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)




% APOE 22 23 24 34 44 (WIN20)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN20_p01-05.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN20_p06-15.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_22_23_24_34_44/APOE_22_23_24_34_44_WIN20_p16-25.mat';
}
SAVENAME = 'APOE_22_23_24_34_44_WIN50_p01p25';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)

%##############################################################################
%##############################################################################







%##############################################################################
%##############################################################################
% APOE 33 (HILO)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_NNHILO.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_NNHILO.mat';
}
SAVENAME = 'APOE_33_HILO';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)




% APOE 33 (WIN50)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_WIN50.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_WIN50.mat';
}
SAVENAME = 'APOE_33_HILO';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)



% APOE 33 (WIN20)
%-------------------------------------------------
FILES = {...
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_WIN20.mat';
'/Users/bradleymonk/Documents/MATLAB/GIT/genomics/genos/genos_data/APOE/APOE_33/APOE_33_WIN20.mat';
}
SAVENAME = 'APOE_33_HILO';
GENOS_SUBSAM_HILO_MATCAT(FILES,SAVENAME)

%##############################################################################
%##############################################################################


%}
%-------------------------------------------------





%% LOAD DATA FROM INDIVIDUAL MAT FILES

ADSP = {};
for i = 1:numel(FILES)
    ADSP{i} = {load(FILES{i})};
end



%% CONCATINATE DATA INTO A SINGLE VARIABLE FOR EACH: LOOPDATA, INFO, P 

clear INFOS
INFOS.APOE      = ADSP{1}{1}.INFO.APOE;
INFOS.TOPLOCI   = ADSP{1}{1}.INFO.TOPLOCI;
INFOS.PHETRCASE = ADSP{1}{1}.INFO.PHETRCASE;
INFOS.PHETRCTRL = ADSP{1}{1}.INFO.PHETRCTRL;
INFOS.PHETECASE = ADSP{1}{1}.INFO.PHETECASE;
INFOS.PHETECTRL = ADSP{1}{1}.INFO.PHETECTRL;
for i = 2:numel(FILES)
INFOS.APOE      = [INFOS.APOE      ADSP{i}{1}.INFO.APOE];
INFOS.TOPLOCI   = [INFOS.TOPLOCI   ADSP{i}{1}.INFO.TOPLOCI];
INFOS.PHETRCASE = [INFOS.PHETRCASE ADSP{i}{1}.INFO.PHETRCASE];
INFOS.PHETRCTRL = [INFOS.PHETRCTRL ADSP{i}{1}.INFO.PHETRCTRL];
INFOS.PHETECASE = [INFOS.PHETECASE ADSP{i}{1}.INFO.PHETECASE];
INFOS.PHETECTRL = [INFOS.PHETECTRL ADSP{i}{1}.INFO.PHETECTRL];
end



clear PDATA
for i = 1:numel(FILES)
PDATA(i).home             = ADSP{i}{1}.P.home;
PDATA(i).P1               = ADSP{i}{1}.P.P1;
PDATA(i).P3               = ADSP{i}{1}.P.P2;
PDATA(i).P2               = ADSP{i}{1}.P.P3;
PDATA(i).P4               = ADSP{i}{1}.P.P4;
PDATA(i).mainmatfile      = ADSP{i}{1}.P.mainmatfile;
PDATA(i).Nloops           = ADSP{i}{1}.P.Nloops;
try PDATA(i).FileStart    = ADSP{i}{1}.P.FileStart; catch; end
PDATA(i).Nvars            = ADSP{i}{1}.P.Nvars;
PDATA(i).windowSize       = ADSP{i}{1}.P.windowSize;
PDATA(i).Ndots            = ADSP{i}{1}.P.Ndots;
PDATA(i).Lo2Hi            = ADSP{i}{1}.P.Lo2Hi;
try PDATA(i).RemoveGenesByName= ADSP{i}{1}.P.RemoveGenesByName; catch; end
PDATA(i).basedir          = ADSP{i}{1}.P.basedir;
PDATA(i).importdir        = ADSP{i}{1}.P.importdir;
PDATA(i).APOES            = ADSP{i}{1}.P.APOES;
PDATA(i).FILES            = ADSP{i}{1}.P.FILES;
PDATA(i).Nmatfiles        = ADSP{i}{1}.P.Nmatfiles;
PDATA(i).savepathfile     = ADSP{i}{1}.P.savepathfile;
end


% disp(char(fields(PDATA)))
% for i = 1:numel(FILES)
%     INFOS = ADSP{i}{1}.INFO;
%     LOOPS = ADSP{i}{1}.LOOPDATA;
%     PDATA = ADSP{i}{1}.P;
% end




clear LOOPS
LOOPS.TR_ALL_STATS = ADSP{1}{1}.LOOPDATA.TR_ALL_STATS;
LOOPS.HO_ALL_STATS = ADSP{1}{1}.LOOPDATA.HO_ALL_STATS;
LOOPS.TR_TOP_STATS = ADSP{1}{1}.LOOPDATA.TR_TOP_STATS;
LOOPS.HO_TOP_STATS = ADSP{1}{1}.LOOPDATA.HO_TOP_STATS;
LOOPS.CATRMEAN     = ADSP{1}{1}.LOOPDATA.CATRMEAN    ;
LOOPS.CATRHIMU     = ADSP{1}{1}.LOOPDATA.CATRHIMU    ;
LOOPS.CATRHIPO     = ADSP{1}{1}.LOOPDATA.CATRHIPO    ;
LOOPS.CAHOMEAN     = ADSP{1}{1}.LOOPDATA.CAHOMEAN    ;
LOOPS.CAHOHIMU     = ADSP{1}{1}.LOOPDATA.CAHOHIMU    ;
LOOPS.CAHOHIPO     = ADSP{1}{1}.LOOPDATA.CAHOHIPO    ;
LOOPS.COTRMEAN     = ADSP{1}{1}.LOOPDATA.COTRMEAN    ;
LOOPS.COTRHIMU     = ADSP{1}{1}.LOOPDATA.COTRHIMU    ;
LOOPS.COTRHIPO     = ADSP{1}{1}.LOOPDATA.COTRHIPO    ;
LOOPS.COHOMEAN     = ADSP{1}{1}.LOOPDATA.COHOMEAN    ;
LOOPS.COHOHIMU     = ADSP{1}{1}.LOOPDATA.COHOHIMU    ;
LOOPS.COHOHIPO     = ADSP{1}{1}.LOOPDATA.COHOHIPO    ;
LOOPS.CATRMEAN_LR  = ADSP{1}{1}.LOOPDATA.CATRMEAN_LR ;
LOOPS.CATRHIMU_LR  = ADSP{1}{1}.LOOPDATA.CATRHIMU_LR ;
LOOPS.CATRHIPO_LR  = ADSP{1}{1}.LOOPDATA.CATRHIPO_LR ;
LOOPS.CAHOMEAN_LR  = ADSP{1}{1}.LOOPDATA.CAHOMEAN_LR ;
LOOPS.CAHOHIMU_LR  = ADSP{1}{1}.LOOPDATA.CAHOHIMU_LR ;
LOOPS.CAHOHIPO_LR  = ADSP{1}{1}.LOOPDATA.CAHOHIPO_LR ;
LOOPS.COTRMEAN_LR  = ADSP{1}{1}.LOOPDATA.COTRMEAN_LR ;
LOOPS.COTRHIMU_LR  = ADSP{1}{1}.LOOPDATA.COTRHIMU_LR ;
LOOPS.COTRHIPO_LR  = ADSP{1}{1}.LOOPDATA.COTRHIPO_LR ;
LOOPS.COHOMEAN_LR  = ADSP{1}{1}.LOOPDATA.COHOMEAN_LR ;
LOOPS.COHOHIMU_LR  = ADSP{1}{1}.LOOPDATA.COHOHIMU_LR ;
LOOPS.COHOHIPO_LR  = ADSP{1}{1}.LOOPDATA.COHOHIPO_LR ;
for i = 2:numel(FILES)
LOOPS.CATRMEAN     = [LOOPS.CATRMEAN ADSP{i}{1}.LOOPDATA.CATRMEAN]    ;
LOOPS.CATRHIMU     = [LOOPS.CATRHIMU ADSP{i}{1}.LOOPDATA.CATRHIMU]    ;
LOOPS.CATRHIPO     = [LOOPS.CATRHIPO ADSP{i}{1}.LOOPDATA.CATRHIPO]    ;
LOOPS.CAHOMEAN     = [LOOPS.CAHOMEAN ADSP{i}{1}.LOOPDATA.CAHOMEAN]    ;
LOOPS.CAHOHIMU     = [LOOPS.CAHOHIMU ADSP{i}{1}.LOOPDATA.CAHOHIMU]    ;
LOOPS.CAHOHIPO     = [LOOPS.CAHOHIPO ADSP{i}{1}.LOOPDATA.CAHOHIPO]    ;
LOOPS.COTRMEAN     = [LOOPS.COTRMEAN ADSP{i}{1}.LOOPDATA.COTRMEAN]    ;
LOOPS.COTRHIMU     = [LOOPS.COTRHIMU ADSP{i}{1}.LOOPDATA.COTRHIMU]    ;
LOOPS.COTRHIPO     = [LOOPS.COTRHIPO ADSP{i}{1}.LOOPDATA.COTRHIPO]    ;
LOOPS.COHOMEAN     = [LOOPS.COHOMEAN ADSP{i}{1}.LOOPDATA.COHOMEAN]    ;
LOOPS.COHOHIMU     = [LOOPS.COHOHIMU ADSP{i}{1}.LOOPDATA.COHOHIMU]    ;
LOOPS.COHOHIPO     = [LOOPS.COHOHIPO ADSP{i}{1}.LOOPDATA.COHOHIPO]    ;
LOOPS.CATRMEAN_LR  = [LOOPS.CATRMEAN_LR ADSP{i}{1}.LOOPDATA.CATRMEAN_LR] ;
LOOPS.CATRHIMU_LR  = [LOOPS.CATRHIMU_LR ADSP{i}{1}.LOOPDATA.CATRHIMU_LR] ;
LOOPS.CATRHIPO_LR  = [LOOPS.CATRHIPO_LR ADSP{i}{1}.LOOPDATA.CATRHIPO_LR] ;
LOOPS.CAHOMEAN_LR  = [LOOPS.CAHOMEAN_LR ADSP{i}{1}.LOOPDATA.CAHOMEAN_LR] ;
LOOPS.CAHOHIMU_LR  = [LOOPS.CAHOHIMU_LR ADSP{i}{1}.LOOPDATA.CAHOHIMU_LR] ;
LOOPS.CAHOHIPO_LR  = [LOOPS.CAHOHIPO_LR ADSP{i}{1}.LOOPDATA.CAHOHIPO_LR] ;
LOOPS.COTRMEAN_LR  = [LOOPS.COTRMEAN_LR ADSP{i}{1}.LOOPDATA.COTRMEAN_LR] ;
LOOPS.COTRHIMU_LR  = [LOOPS.COTRHIMU_LR ADSP{i}{1}.LOOPDATA.COTRHIMU_LR] ;
LOOPS.COTRHIPO_LR  = [LOOPS.COTRHIPO_LR ADSP{i}{1}.LOOPDATA.COTRHIPO_LR] ;
LOOPS.COHOMEAN_LR  = [LOOPS.COHOMEAN_LR ADSP{i}{1}.LOOPDATA.COHOMEAN_LR] ;
LOOPS.COHOHIMU_LR  = [LOOPS.COHOHIMU_LR ADSP{i}{1}.LOOPDATA.COHOHIMU_LR] ;
LOOPS.COHOHIPO_LR  = [LOOPS.COHOHIPO_LR ADSP{i}{1}.LOOPDATA.COHOHIPO_LR] ;
end


for i = 2:numel(FILES)

Asz = size(LOOPS.TR_ALL_STATS,3);
Bsz = size(ADSP{i}{1}.LOOPDATA.TR_ALL_STATS,3);

LOOPS.TR_ALL_STATS(:,:,(Asz+1):(Asz+Bsz)) = ADSP{i}{1}.LOOPDATA.TR_ALL_STATS;
LOOPS.HO_ALL_STATS(:,:,(Asz+1):(Asz+Bsz)) = ADSP{i}{1}.LOOPDATA.HO_ALL_STATS;
LOOPS.TR_TOP_STATS(:,:,(Asz+1):(Asz+Bsz)) = ADSP{i}{1}.LOOPDATA.TR_TOP_STATS;
LOOPS.HO_TOP_STATS(:,:,(Asz+1):(Asz+Bsz)) = ADSP{i}{1}.LOOPDATA.HO_TOP_STATS;
end

clearvars -except FILES SAVENAME LOOPS INFOS PDATA





%% SAVE THE COMBINED DATASET TO A MAT FILE

LOOPDATA = LOOPS;
INFO     = INFOS;
P        = PDATA;

save(SAVENAME,'LOOPDATA','INFO','P');
disp('MATCAT successful!');



%%
end